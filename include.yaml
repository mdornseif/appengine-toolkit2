#
# using `includes` retrieves only the following types of directives :
# * builtins
# * includes
# * handlers
# * skip_files

builtins:
- remote_api: off
- appstats: on
- deferred: on
# See also https://github.com/freshplanet/AppEngine-Deferred
# for an alternative


includes:
- lib/site-packages/mapreduce/include.yaml

# Patterns are evaluated in the order they appear in the app.yaml file,
# from top to bottom. The first mapping whose pattern matches the URL
# is the one used to handle the request.
handlers:
# needed to allow abritary postfixes for better overview during logging
- url: /_ah/queue/deferred(.*)
  script: google.appengine.ext.deferred.deferred.application
  login: admin

# static files / bootstrap
- url: /gaetk2/static
  static_dir: lib/appengine-toolkit2/static
  http_headers:
    Access-Control-Allow-Origin: "*"

- url: /favicon\.ico
  static_files: static/icons/favicon.ico
  upload: static/icons/favicon.ico
  expiration: "10d"
- url: /(apple-touch-icon[\dx-]*?)(-precomposed)?\.png
  static_files: static/icons/\1.png
  upload: static/icons/apple-.*png
  expiration: "10d"
# /browserconfig.xml

# Simple minded handlers for simple tasks
- url: /(robots.txt|version.txt|_ah/warmup)
  script: gaetk2.views.default.application

# Unfortunately not allowed in includes
# error_handlers:
# - file: lib/appengine-toolkit2/templates/error/500.html
#  - error_code: over_quota
#    file: templates/error_over_quota.html
#  - error_code: dos_api_denial
#    file: templates/error_dos_api_denial.html
#  - error_code: timeout
#    file: templates/error_timeout.html

# `libraries:` unfortunately is ignored during including

skip_files:
- .*/requirements.txt
- .*\.graffle
- .*\.jar
- .*MANIFEST.in
- .*PKG-INFO
- ^(.*/)?(CHANGES|LICENSE|AUTHORS)
- ^(.*/)?.*\.py[co]
- ^(.*/)?.*~
- ^(.*/)?\..*
- ^(.*/)?\.[^c].*
- ^(.*/)?app\.yaml
- ^(.*/)?index\.yaml
- ^(.*/)?lib/.*/(tests|testsuite)/.*
- ^(.*/)?lib/.*google_appengine/.*
- ^(.*/)?lib/CentralServices/keys/.*
- ^(.*/)?lib/fmtp/printclient/.*
- ^(.*/)?lib/gae-sessions/(demo|demo-with-google-logins|docs|tests)/.*
- ^(.*/)?lib/google_appengine/.*
- ^(.*/)?lib/site-packages/lxml/.*
- ^(.*/)?lib/py2js/.*
- ^(.*/)?Makefile
- ^(.*/)?node_modules/.*
- ^(.*/)?requirements\.txt
- ^(.*/)?setup.py
- ^.*/(bin)?/.*
- ^.*/(doc|example|test|bin)s?/.*
- ^.+/README.*
- ^js_src/.*
- ^tmp/.*
- ^venv/.*
- js_*/.*
